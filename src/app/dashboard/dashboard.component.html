<div class="view">
  <div class="view__header">
    <h1 class="view__header-title">Omat tehtävät</h1>
    <a routerLink="/library" class="view__add">Uusi tehtävä</a>
  </div>
  <div class="view__content">
    <div class="view__columns">
      <div class="view__column">          
<!--
        <div class="view__filters">
          <div class="view__filter">
            <div class="view__filter-dropdown">
              <div class="view__filter-dropdown-title">Tekijä</div>
              <div class="view__filter-dropdown-handle"></div>
              <div class="view__filter-dropdown-content">
                <div class="view__filter-dropdown-row">Minä</div>
                <div class="view__filter-dropdown-row">Opettaja</div>
              </div>
            </div>
          </div>
          <div class="view__filter">
            <div class="view__filter-dropdown">
              <div class="view__filter-dropdown-title">Tyyppi</div>
              <div class="view__filter-dropdown-handle"></div>
              <div class="view__filter-dropdown-content">
                <div class="view__filter-dropdown-row">Toimi</div>
                <div class="view__filter-dropdown-row">Tutki</div>
                <div class="view__filter-dropdown-row">Tee</div>
              </div>
            </div>
          </div>
        </div>
-->
        <div class="list type--tasks">
          <div class="list__item type--code">
            <form (ngSubmit)="addTask()" #newTaskForm="ngForm">
              <div class="list__item-title">Lataa tehtävä koodilla.</div>
              <div class="list__item-error" *ngIf="formError == 'not found'">
                <div class="text">Tehtävää ei löytynyt. Tarkista että koodi on oikein ja yritä uudestaan.</div>
              </div>
              <div class="list__item-footer">
                <div class="list__item-input">
                  <input type="text" class="input--code" maxlength="1" required [(ngModel)]="model.code[0]" id="code0" name="code0" #code0="ngModel" (keyup)="setKeyIfOk(0, $event.key)">
                  <input type="text" class="input--code" maxlength="1" required [(ngModel)]="model.code[1]" id="code1" name="code1" #code1="ngModel" (keyup)="setKeyIfOk(1, $event.key)">
                  <input type="text" class="input--code" maxlength="1" required [(ngModel)]="model.code[2]" id="code2" name="code2" #code2="ngModel" (keyup)="setKeyIfOk(2, $event.key)">
                  <input type="text" class="input--code" maxlength="1" required [(ngModel)]="model.code[3]" id="code3" name="code3" #code3="ngModel" (keyup)="setKeyIfOk(3, $event.key)">
                  <input type="text" class="input--code" maxlength="1" required [(ngModel)]="model.code[4]" id="code4" name="code4" #code4="ngModel" (keyup)="setKeyIfOk(4, $event.key)">
                </div>
              </div>
            </form>
          </div>
          <div class="list__item" *ngFor="let t of tasks" [ngClass]="{'is-new': t.id == taskId}">
            <a [routerLink]="['/map', t.id]">
              <div class="list__item-status" *ngIf="t.id == taskId">
                <div class="status">Uusi</div>
              </div>
              <div class="list__item-image type--2"></div>
              <div class="list__item-title">{{t.name}}</div>
              <div class="list__item-detail">{{t.resultItemCount}} merkintää</div>
              <!--
              <div class="list__item-marks"> 
                <div class="list__item-mark"></div>
                <div class="list__item-mark"></div>
                <div class="list__item-mark"></div>
              </div>
              -->
            </a>
            <div class="list__item-code" *ngIf="role === 'teacher'">
              <div class="code">{{t.code}}</div>
            </div>
          </div>
        </div>
        <div class="list type--tasks" style="display: block;" *ngIf="unusedCodes?.length > 0">
          <div class="list__item-title" style="color: gray;">Käyttämättömät koodit
            <span style="color: gray; font-size: 0.8rem;">(näytetään vain protossa)</span>
          </div>
          <code>
            <ng-container *ngFor="let code of unusedCodes">{{code}}<br/></ng-container>
          </code>
        </div>
      </div>
      <div class="view__column">
        <div class="view__column">
          <div class="profile">
            <div class="profile__item">
              <div class="profile__image">
                <div class="image variant--1"></div>
              </div>
            </div>
            <div class="profile__item">
              <label>{{user.firstName}} {{user.lastName}}</label><br/>
              <label>{{user.school}} / {{user.schoolClass}}</label><br/>
              <label>{{user.municipality}}</label>
            </div>
            <!--
            <div class="profile__item">
              <div class="rank">Tason 5 tutkija</div>
            </div>
            -->
            <div class="profile__medals">
              <!--
              <div class="profile__medal type--1">5</div>
              <div class="profile__medal type--2">5</div>
              <div class="profile__medal type--3">10</div>
              <div class="profile__medal type--4">15</div>
              <div class="profile__medal type--5">25</div>
              <div class="profile__medal type--6 is-empty"></div>
              -->
              <div class="profile__medals-footer">
                <!--
                <div class="link">Näytä kaikki saavutukset</div>
                -->
              </div>
            </div>
            <div class="profile__footer">
              <div class="profile__footer-item">
                <a (click)="logout()">Kirjaudu ulos</a>
              </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
