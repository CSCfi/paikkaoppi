<div class="popup" *ngIf="visible === true">
  <div class="popup__content">
    <div class="form type--basic">
      <div class="popup__header"><a (click)="close()" class="popup__header-link type--back"></a>
        <h1 class="popup__header-title" *ngIf="!isEditMode">Merkintä</h1>
        <h1 class="popup__header-title" *ngIf="isEditMode && model.isNew">Uusi merkintä</h1>
        <h1 class="popup__header-title" *ngIf="isEditMode && !model.isNew">Päivitä merkintää</h1>
      </div>
      <div class="form__text" *ngIf="showUser">
        <div class="form__text-title">Käyttäjä</div>
        <div class="form__text-value">{{result.user.firstName}} {{result.user.lastName}} {{result.user.email}}</div>
      </div>
      <div class="form__text">
        <ng-container *ngIf="isPoint">
          <div class="form__text-title">Koordinaatit ETRS-TM35FIN</div>
          <div class="form__text-value">N:{{model.geometry.coordinates[0]}} E:{{model.geometry.coordinates[1]}}</div>
          <div class="form__text-title">Koordinaatit WGS84</div>
          <div class="form__text-value">N:{{pointWGS84Coordinates.lat.asString(3)}} E:{{pointWGS84Coordinates.lon.asString(3)}}</div>
        </ng-container>
        <ng-container *ngIf="isPolygon">
          <div class="form__text-title">Koordinaatit ETRS-TM35FIN</div>
          <div class="form__text-value">
            <ul>
              <li *ngFor="let c of polygonCoordinates">N:{{c[0]}} E:{{c[1]}}</li>
            </ul>
          </div>
          <div class="form__text-title">Koordinaatit WGS84</div>
          <div class="form__text-value">
            <ul>
              <ng-template ngFor let-c [ngForOf]="polygonWGS84Coordinates">
                <li>N:{{c.lat.asString(3)}} E:{{c.lon.asString(3)}}</li>
              </ng-template>
            </ul>
          </div>
        </ng-container>
      </div>
      <ng-container *ngIf="isEditMode">
        <form (ngSubmit)="save()" #resultItemForm="ngForm">
          <div class="form__item" [class.has-error]="name.invalid && name.dirty">
            <label>Nimi</label>
            <input type="text" required [(ngModel)]="model.name" name="name" #name="ngModel">
            <div [hidden]="name.valid || name.pristine" class="alert alert-danger">Pakollinen tieto</div>
          </div>
          <div class="form__item">
            <label>Kuvaus</label>
            <textarea [(ngModel)]="model.description" name="description"></textarea>
          </div>
          <div class="form__footer">
            <button type="submit" class="button" [disabled]="!resultItemForm.form.valid">Tallenna merkintä</button>
            <button class="button type--secondary" (click)="delete()" *ngIf="model['id'] != null">Poista merkintä</button>
            <button class="button type--secondary" (click)="close()">Sulje</button>
          </div>
        </form>
      </ng-container>
      <ng-container *ngIf="!isEditMode">
        <div class="form__item">
          <label>Nimi</label>
          <div class="form__value">{{model.name}}</div>
        </div>
        <div class="form__item">
          <label>Kuvaus</label>
          <div class="form__value">{{model.description}}</div>
        </div>
        <div class="form__footer" *ngIf="!showUser">
          <button class="button" (click)="edit()">Muokkaa merkintää</button>
          <button class="button type--secondary" (click)="close()">Sulje</button>
        </div>
        <div class="form__footer" *ngIf="showUser">
          <button class="button" (click)="close()">Sulje</button>
        </div>
      </ng-container>
    </div>
  </div>
</div>